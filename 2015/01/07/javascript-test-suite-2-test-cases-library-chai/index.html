<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>[JavaScript] Test Suite 2 - Test Cases Library - Chai | Veck's Blog</title><link rel="stylesheet" type="text/css" href="/Veck//css/normalize.css"><link rel="stylesheet" type="text/css" href="/Veck//css/highlight.css"><link rel="stylesheet" type="text/css" href="/Veck//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/Veck/favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/Veck/." class="title">Veck's Blog</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/Veck" class="sidebar-nav-item">Home</a><a href="/Veck/archives" class="sidebar-nav-item">Archives</a><a href="/Veck/about.html" class="sidebar-nav-item">About</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>[JavaScript] Test Suite 2 - Test Cases Library - Chai</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2015-01-07</div></div></div><article><div class="container post"><h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><ol>
<li><code>npm install chai</code>, bundle with package</li>
<li>官網補充：dependency and mocha<br><img src="http://user-image.logdown.io/user/3330/blog/3407/post/248476/Cijx7PR1RSe5PT34tPZe_dep.png" alt="dep.png"></li>
</ol>
<a id="more"></a>
<h1 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h1><p>在 mocha 中，我們有這樣一段程式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">describe(&#39;Array&#39;, function()&#123;    &#10;   describe(&#39;#indexOf()&#39;, function()&#123;&#10;      it(&#39;should return -1 when the value is not present&#39;, function()&#123;  &#10;         assert.equal(-1, [1, 2, 3].indexOf(5)) &#10;         assert.equal(-1, [1, 2, 3].indexOf(0))&#10;      &#125;)&#10;   &#125;)&#10;&#125;);</span><br></pre></td></tr></table></figure></p>
<p>其中 node 本身雖然也提供 assert，但是 chai 專門針對這部份提供更多 API，以下是官網的說明：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The assert style is exposed through assert interface. &#10;This provides the classic assert-dot notation, similiar to that packaged with node.js. &#10;This assert module, however, provides several additional tests and is browser compatible.</span><br></pre></td></tr></table></figure></p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><h2 id="Assert"><a href="#Assert" class="headerlink" title="Assert"></a>Assert</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> var assert = require(&#39;chai&#39;).assert&#10;  , foo = &#39;bar&#39;&#10;  , beverages = &#123; tea: [ &#39;chai&#39;, &#39;matcha&#39;, &#39;oolong&#39; ] &#125;;&#10;&#10;describe(&#34;try chai with mocha&#34;, function()&#123;&#10;     it(&#34;typeOf&#34;, function()&#123;&#10;        assert.typeOf(foo, &#39;string&#39;, &#39;foo is a string&#39;);&#10;     &#125;)&#10;  &#10;     it(&#34;chai&#39;s equal&#34;, function()&#123;&#10;         assert.equal(foo, &#39;bar&#39;, &#39;foo equal `bar`&#39;);&#10;     &#125;)&#10;  &#10;     it(&#34;lengthOf&#34;, function()&#123;&#10;        assert.lengthOf(foo, 4, &#39;foo`s value has a length of 3&#39;);&#10;     &#125;)&#10;  &#10;     it(&#34;lengthOf in array&#34;, function()&#123;&#10;        assert.lengthOf(beverages.tea, 3, &#39;beverages has 3 types of tea&#39;);&#10;     &#125;)&#10;  &#125;);</span><br></pre></td></tr></table></figure>
<p>(因為是不同的 test case，所以一個 it 只會執行一種 assert，因此才要分開不同 it)</p>
<p>存檔成 test.js 後就可以用 mocha 來執行測試了:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">try chai with mocha&#10;   &#10003; typeOf &#10;   &#10003; chai&#39;s equal &#10;   1) lengthOf&#10;   &#10003; lengthOf in array &#10;&#10;&#10; 3 passing (9ms)&#10; 1 failing&#10;&#10; 1) try chai with mocha lengthOf:&#10;    AssertionError: foo`s value has a length of 3: expected &#39;bar&#39; to have a length of 4 but got 3&#10;     at Function.assert.lengthOf (/Users/veck/Desktop/JSTest/2_mocha_chai/node_modules/chai/lib/chai/interface/assert.js:890:37)&#10;     at Context.&#60;anonymous&#62; (/Users/veck/Desktop/JSTest/2_mocha_chai/test.js:15:14)&#10;     at callFn (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runnable.js:251:21)&#10;     at Test.Runnable.run (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runnable.js:244:7)&#10;     at Runner.runTest (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:374:10)&#10;     at /Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:452:12&#10;     at next (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:299:14)&#10;     at /Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:309:7&#10;     at next (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:248:23)&#10;     at Object._onImmediate (/Users/veck/.nvm/v0.10.35/lib/node_modules/mocha/lib/runner.js:276:5)&#10;     at processImmediate [as _immediateCallback] (timers.js:354:15)</span><br></pre></td></tr></table></figure></p>
<h2 id="Expect"><a href="#Expect" class="headerlink" title="Expect"></a>Expect</h2><p>BDD(behavior driven development) 的開發模式產生了兩種常用的測試方法：<code>expect</code> 和 <code>should</code></p>
<p>(以下省略 mocha 部分程式碼)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var expect = require(&#39;chai&#39;).expect&#10;  , foo = &#39;bar&#39;&#10;  , beverages = &#123; tea: [ &#39;chai&#39;, &#39;matcha&#39;, &#39;oolong&#39; ] &#125;;&#10;&#10;expect(foo).to.be.a(&#39;string&#39;);&#10;expect(foo).to.equal(&#39;bar&#39;);&#10;expect(foo).to.have.length(3);&#10;expect(beverages).to.have.property(&#39;tea&#39;).with.length(3);</span><br></pre></td></tr></table></figure></p>
<h2 id="Should"><a href="#Should" class="headerlink" title="Should"></a>Should</h2><p><code>should</code> 跟 <code>expect</code> 基本上一樣，差別在於方法的實作上，expect 是做成 global function，而 should 是 class property，也就是物件可以用 property 的方式呼叫 expect 的測試案例</p>
<p>還有一點就是，<code>expect</code> 引用是用 <code>require(&#39;chai&#39;).expect</code>，但 <code>should</code> 是用 <code>require(&#39;chai&#39;).should()</code></p>
<p>NOTICE: This style has some issues when used Internet Explorer, so be aware of browser compatibility.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var should = require(&#39;chai&#39;).should() //actually call the the function&#10;  , foo = &#39;bar&#39;&#10;  , beverages = &#123; tea: [ &#39;chai&#39;, &#39;matcha&#39;, &#39;oolong&#39; ] &#125;;&#10;&#10;foo.should.be.a(&#39;string&#39;);&#10;foo.should.equal(&#39;bar&#39;);&#10;foo.should.have.length(3);&#10;beverages.should.have.property(&#39;tea&#39;).with.length(3);</span><br></pre></td></tr></table></figure></p>
<h1 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h1><p>Chai 可以透過下面的方法來取用外部工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chai.use(_chai, util)&#123;&#10;&#9;// your helpers here&#10;&#125;</span><br></pre></td></tr></table></figure></p>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'vecktw';
var disqus_identifier = '2015/01/07/javascript-test-suite-2-test-cases-library-chai/';
var disqus_title = '[JavaScript] Test Suite 2 - Test Cases Library - Chai';
var disqus_url = 'http://fbukevin.github.io/Veck/2015/01/07/javascript-test-suite-2-test-cases-library-chai/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:fbukevin@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="http://twitter.com/VeckHsiao" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/fbukevin" target="_blank"><i class="fa fa-github"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2016 <a href="/" rel="nofollow">Veck's Blog</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});</script></body></html>