<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Hadoop Code Study - Mapper and Reducer Class Type | Veck's Blog</title><link rel="stylesheet" type="text/css" href="/Veck//css/normalize.css"><link rel="stylesheet" type="text/css" href="/Veck//css/highlight.css"><link rel="stylesheet" type="text/css" href="/Veck//css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/Veck/favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/Veck/." class="title">Veck's Blog</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item">Home</a><a href="/Veck/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>Hadoop Code Study - Mapper and Reducer Class Type</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2014-09-08</div></div></div><article><div class="container post"><h1 id="u4EE5_Mapper__u4F86_u8AAA"><a href="#u4EE5_Mapper__u4F86_u8AAA" class="headerlink" title="以 Mapper 來說"></a>以 Mapper 來說</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> public class TokenCounterMapper &#10;     extends Mapper&#60;Object, Text, Text, IntWritable&#62;&#123;&#10;    &#10;   private final static IntWritable one = new IntWritable(1);&#10;   private Text word = new Text();&#10;   &#10;   public void map(Object key, Text value, Context context) throws IOException, InterruptedException &#123;&#10;     StringTokenizer itr = new StringTokenizer(value.toString());&#10;     while (itr.hasMoreTokens()) &#123;&#10;       word.set(itr.nextToken());&#10;       context.write(word, one);&#10;     &#125;&#10;   &#125;&#10; &#125;&#10;``` &#10; `&#60;Obejct, Text, Text, IntWritable&#62;` &#20998;&#21029;&#23565;&#25033;&#21040; KEYIN, VALUEIN, KEYOUT, VALUEOUT&#10;&#32780;&#22312; mapper &#20989;&#25976;&#20013;&#20351;&#29992;&#21040;&#30340;&#37096;&#20221;&#65306;&#10;* public void map(Object key, Text value, Context context) &#30340;&#38957;&#20841;&#20491;&#21443;&#25976;&#23601;&#26159;&#31526;&#21512; KEYIN &#21644; VALUEIN &#30340;&#37096;&#20998;&#10;* context.write(word, one) &#30340; word &#21644; one &#23601;&#20998;&#21029;&#23565;&#25033;&#21040; KEYOUT &#21644; VALUEOUT&#10;&#10; &#10;&#10;&#20197; Reducer &#20358;&#35498;&#10;===</span><br></pre></td></tr></table></figure>
<p> public class IntSumReducer<key> extends Reducer<key,intwritable, key,intwritable="">{<br>     private IntWritable result = new IntWritable();<br>   public void reduce(Key key, Iterable<intwritable> values, Context context) throws IOException, InterruptedException {<br>     int sum = 0;<br>     for (IntWritable val : values) {<br>       sum += val.get();<br>     }<br>     result.set(sum);<br>     context.write(key, result);<br>   }<br> }<br><code>`` </code><key, intwritable,="" key,="" intwritable="">` 分別對應到 KEYIN, VALUEIN, KEYOUT, VALUEOUT<br>而在 reduce 函數中使用到的部份：</key,></intwritable></key,intwritable,></key></p>
<ul>
<li>public void reduce(Key key, Interable<intwritable> values, Context context) 的頭兩個參數就是符合 KEYIN 和 VALUEIN 的部分</intwritable></li>
<li>context.write(key, result) 的 key 和 result 就分別對應到 KEYOUT 和 VALUEOUT</li>
</ul>
<p>Reference:</p>
<ol>
<li><a href="http://blog.csdn.net/jerome_s/article/details/26213099" target="_blank" rel="external">MapReduce：并行计算框架</a></li>
<li><a href="http://blog.csdn.net/workformywork/article/details/14127823" target="_blank" rel="external">Hadoop入门实践之类型与格式</a></li>
</ol>
</div><!-- comment system--><div class="container"><hr><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'veckhtw';
var disqus_identifier = '2014/09/08/hadoop-mapper-and-reducer-code-study-1/';
var disqus_title = 'Hadoop Code Study - Mapper and Reducer Class Type';
var disqus_url = 'http://fbukevin.github.io/Veck/2014/09/08/hadoop-mapper-and-reducer-code-study-1/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:fbukevin@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="http://twitter.com/VeckHsiao" target="_blank"><i class="fa fa-twitter"></i></a><a href="https://github.com/fbukevin" target="_blank"><i class="fa fa-github"></i></a><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2016 <a href="/" rel="nofollow">Veck's Blog</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});</script></body></html>